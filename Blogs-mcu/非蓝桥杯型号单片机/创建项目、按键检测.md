## 创建工程项目及新建项目文件
#### 1.创建工程项目
![alt text](https://i-blog.csdnimg.cn/blog_migrate/21dd58b92a80edd6e9a15c6aa6439da7.png)
![alt text](https://i-blog.csdnimg.cn/blog_migrate/35d0a604892cadf793494c9ca667e659.png)
![alt text](https://i-blog.csdnimg.cn/blog_migrate/a775113a932495e88b5cf60ac66bf42c.png)

然后它会要求你将核心工程文件保存在某个地方。
不过，我们别急着随便找个地方就直接保存这个工程文件，因为我们后期的单片机工程越复杂，文件越多，我们越不好去找。因此，我们必须学会建立多个文件夹，根据不同功能和用途来对这整个工程文件进行保存。
![https://i-blog.csdnimg.cn/blog_migrate/07dd92dc28d1a1609950b6fa99d8fe73.png](https://i-blog.csdnimg.cn/blog_migrate/07dd92dc28d1a1609950b6fa99d8fe73.png)
![alt text](https://i-blog.csdnimg.cn/blog_migrate/dd35991248d1ec750edfe47bef84e3a8.png)
 我们将核心文件命名为Temp然后保存即可。

 保存成功后，我们就到了挑选芯片类型的环节：
 ![alt text](https://i-blog.csdnimg.cn/blog_migrate/f913096f6c0312d031f24807eb246bdb.png)
如果要找51单片机的芯片，需要切换software Packs一栏，如图：
![alt text](https://i-blog.csdnimg.cn/blog_migrate/5e8420f3599edf1b9841fc0ac8e78a77.png)
如果新建的是51单片机工程，那么我们一般找的芯片类型是AT89C51以及AT89C52。（后者是前者的升级版，主要是扩宽了缓存容量以及增加定时器数量，你需要按需求选取，但一般新手学习时一般不用注重这个东西，选哪个都一样）

我们以AT89C51芯片为例：
![img](https://img2023.cnblogs.com/blog/3583913/202502/3583913-20250210205011765-1175536316.png)

#### 2.新建编程文件
我们继续以C51工程为例，首先我们需要点击这个图标：
![img](https://img2023.cnblogs.com/blog/3583913/202502/3583913-20250210205041077-1832832165.png)
看见以下界面，我们点击C51这一栏
[![alt text](image-2.png)](https://i-blog.csdnimg.cn/blog_migrate/9cc9f72bac92109bf65f98fd2517ed9a.png)
之后我们要在Include Paths里选择C51核心文件的所在地，不然我们无法引用头文件，也就无法进行下次的编译（这个需要每次建立新工程时进行设置） 如图：
![alt text](https://i-blog.csdnimg.cn/blog_migrate/6025f59b273e50dc1c1c4af6df3ebb71.png)
![alt text](https://i-blog.csdnimg.cn/blog_migrate/2cef0863d55563a236dc460ce2114de2.png)
![alt text](https://i-blog.csdnimg.cn/blog_migrate/89d0d044767cb098b3c28851e8f0df1d.png)

下面的设置是额外需要自己手动配置的

![alt text](https://i-blog.csdnimg.cn/blog_migrate/cd46142a1cc20cb89f61641fc4d665d6.png)
![alt text](https://i-blog.csdnimg.cn/blog_migrate/ae8054f929b27a24c7d1ff404ec1b726.png)



## 按键检测
#### 独立按键检测（非矩阵键盘）
>能通过判断i/o接口的值（由原理图可知，按键按下i/o接口值为0）判断是哪个按键被按下。
![img](https://img2023.cnblogs.com/blog/3583913/202501/3583913-20250128090434835-858079307.png)
![img](https://img2023.cnblogs.com/blog/3583913/202501/3583913-20250128090612981-930264987.png)

按键的操作分为按键下降沿，上升沿和是否一直按下三个状态。代码实现如下：
```cpp
//变量声明
unsigned char key_val, key_down, key_up, key_old;//全局变量

//读按键函数
unsigned char key_read(){     //缺点：原代码 key_read()不能正确检测多个按键
	unsigned char temp = 0;
	if(P3_4 == 0) temp = 1;
	if(P3_5 == 0) temp = 2;
	if(P3_6 == 0) temp = 3;
	if(P3_7 == 0) temp = 4;
	return temp;
}

//按键操作的计算：
while(1){
	key_val = key_read();		
	key_down = key_val & (key_val ^ key_old);  
	key_up = ~key_val & (key_val ^ key_old); 
	key_old = key_val;							
	}

//建议使用下述等效表达：
 while(1){
        key_val = key_read();               // 读取当前按键状态
        key_down = key_val & ~key_old;      // 检测按键按下瞬间
        key_up = (~key_val) & key_old;      // 检测按键松开瞬间
        key_old = key_val;                  // 记录当前按键状态
    }
```
#### 矩阵键盘检测
```cpp
//变量声明
unsigned char key_val, key_down, key_up, key_old;//全局变量

//读按键函数
unsigned char key_read(){     //按键的按下时间远远大于程序运行一次的时间
	unsigned char temp = 0;

	P3_0 = 0, P3_1 = 1, P3_2 = 1, P3_3 = 1;
	if(P3_4 == 0) temp = 1;
	if(P3_5 == 0) temp = 2;
	if(P3_6 == 0) temp = 3;
	if(P3_7 == 0) temp = 4;

	P3_0 = 1, P3_1 = 0, P3_2 = 1, P3_3 = 1;
	if(P3_4 == 0) temp = 5;
	if(P3_5 == 0) temp = 6;
	if(P3_6 == 0) temp = 7;
	if(P3_7 == 0) temp = 8;

	P3_0 = 1, P3_1 = 1, P3_2 = 0, P3_3 = 1;
	if(P3_4 == 0) temp = 9;
	if(P3_5 == 0) temp = 10;
	if(P3_6 == 0) temp = 11;
	if(P3_7 == 0) temp = 12;

	P3_0 = 1, P3_1 = 1, P3_2 = 1, P3_3 = 0;
	if(P3_4 == 0) temp = 13;
	if(P3_5 == 0) temp = 14;
	if(P3_6 == 0) temp = 15;
	if(P3_7 == 0) temp = 16;

	return temp;
}
```
#### 简单延时函数的实现
```cpp
//延时函数
void Delay_1ms(unsigned char xms)		//@12.000MHz
{
	unsigned char i, j;
	while(xms --){
		i = 2;
		j = 239;
		do
		{
			while (--j);
		} while (--i);
	}
}
```
#### 简单流水灯的实现
>库：`#include <intrins.h>`，左移：`_crol()_`， 右移：`_cror()_`

左移、右移与<<、>>的区别：

左移就是一个数的二进制全部向左平移，后面相应的补零
右移就是一个数的二进制全部向右平移，平移的直接去掉

`_cror_(unsigned char, unsigned char);`
该函数是循环右移，如：
`a = 1010;`
`b = _cror_(a, 1);`,也即`b = 010;`,低位补高位；
`_crol_(unsigned char, unsigned char);`
同理，该函数是高位补低位；
